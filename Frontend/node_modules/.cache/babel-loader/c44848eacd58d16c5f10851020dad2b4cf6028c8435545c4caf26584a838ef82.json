{"ast":null,"code":"import { doc, setDoc, getDoc, getDocs, deleteDoc, collection, query, orderBy } from \"firebase/firestore\";\nimport { db, auth } from \"../utils/auth\";\nexport default class TrainingLogManager {\n  constructor() {\n    this.user = auth.currentUser;\n  }\n\n  // Get the current user's UID\n  getUserId() {\n    const user = auth.currentUser;\n    if (!user) {\n      throw new Error(\"User not authenticated\");\n    }\n    return user.uid;\n  }\n\n  // Get Firestore document reference for a specific table\n  getTableDoc(logId) {\n    const userId = this.getUserId();\n    return doc(db, \"users\", userId, \"tables\", logId);\n  }\n\n  // Get Firestore collection reference for user's tables\n  getTablesCollection() {\n    const userId = this.getUserId();\n    return collection(db, \"users\", userId, \"tables\");\n  }\n  async loadTable(id) {\n    try {\n      const docRef = this.getTableDoc(id);\n      const docSnap = await getDoc(docRef);\n      if (docSnap.exists()) {\n        return docSnap.data();\n      } else {\n        return null;\n      }\n    } catch (error) {\n      console.error(\"Error loading table:\", error);\n      return null;\n    }\n  }\n  async saveTable(log) {\n    try {\n      const docRef = this.getTableDoc(log.id);\n      await setDoc(docRef, {\n        ...log,\n        lastOpened: new Date().toISOString()\n      });\n      return {\n        message: \"Saved\"\n      };\n    } catch (error) {\n      console.error(\"Error saving table:\", error);\n      throw new Error(\"Save failed\");\n    }\n  }\n  async deleteTable(id) {\n    try {\n      const docRef = this.getTableDoc(id);\n      await deleteDoc(docRef);\n      return true;\n    } catch (error) {\n      console.error(\"Error deleting table:\", error);\n      throw new Error(\"Delete failed\");\n    }\n  }\n  async listTables() {\n    try {\n      const collectionRef = this.getTablesCollection();\n      const q = query(collectionRef, orderBy(\"lastOpened\", \"desc\"));\n      const querySnapshot = await getDocs(q);\n      const tables = [];\n      querySnapshot.forEach(doc => {\n        const data = doc.data();\n        tables.push({\n          id: data.id,\n          tableName: data.tableName,\n          date: data.date,\n          lastOpened: data.lastOpened\n        });\n      });\n      return tables;\n    } catch (error) {\n      console.error(\"Error listing tables:\", error);\n      return [];\n    }\n  }\n\n  // Get all unique muscle groups from user's logs\n  async getUniqueMuscleGroups() {\n    try {\n      const collectionRef = this.getTablesCollection();\n      const querySnapshot = await getDocs(collectionRef);\n      const muscleGroups = new Set();\n      querySnapshot.forEach(doc => {\n        const data = doc.data();\n        if (data.rows) {\n          data.rows.forEach(row => {\n            if (row.muscleGroup && row.muscleGroup.trim()) {\n              muscleGroups.add(row.muscleGroup.trim());\n            }\n          });\n        }\n      });\n      return Array.from(muscleGroups).sort();\n    } catch (error) {\n      console.error(\"Error fetching muscle groups:\", error);\n      return [];\n    }\n  }\n\n  // Get all unique exercises from user's logs\n  async getUniqueExercises() {\n    try {\n      const collectionRef = this.getTablesCollection();\n      const querySnapshot = await getDocs(collectionRef);\n      const exercises = new Set();\n      querySnapshot.forEach(doc => {\n        const data = doc.data();\n        if (data.rows) {\n          data.rows.forEach(row => {\n            if (row.exercise && row.exercise.trim()) {\n              exercises.add(row.exercise.trim());\n            }\n          });\n        }\n      });\n      return Array.from(exercises).sort();\n    } catch (error) {\n      console.error(\"Error fetching exercises:\", error);\n      return [];\n    }\n  }\n\n  // Get exercises for a specific muscle group\n  async getExercisesForMuscleGroup(muscleGroup) {\n    try {\n      const collectionRef = this.getTablesCollection();\n      const querySnapshot = await getDocs(collectionRef);\n      const exercises = new Set();\n      querySnapshot.forEach(doc => {\n        const data = doc.data();\n        if (data.rows) {\n          data.rows.forEach(row => {\n            if (row.muscleGroup === muscleGroup && row.exercise && row.exercise.trim()) {\n              exercises.add(row.exercise.trim());\n            }\n          });\n        }\n      });\n      return Array.from(exercises).sort();\n    } catch (error) {\n      console.error(\"Error fetching exercises for muscle group:\", error);\n      return [];\n    }\n  }\n  createNewTable() {\n    const id = crypto.randomUUID();\n    const today = new Date().toISOString().split(\"T\")[0];\n    return {\n      id,\n      tableName: \"New Log\",\n      date: today,\n      rows: [{\n        id: 0,\n        muscleGroup: \"\",\n        exercise: \"\",\n        sets: [{\n          reps: \"\",\n          weight: \"\"\n        }],\n        notes: \"\",\n        showNotes: false,\n        weightUnit: \"lbs\"\n      }]\n    };\n  }\n}","map":{"version":3,"names":["doc","setDoc","getDoc","getDocs","deleteDoc","collection","query","orderBy","db","auth","TrainingLogManager","constructor","user","currentUser","getUserId","Error","uid","getTableDoc","logId","userId","getTablesCollection","loadTable","id","docRef","docSnap","exists","data","error","console","saveTable","log","lastOpened","Date","toISOString","message","deleteTable","listTables","collectionRef","q","querySnapshot","tables","forEach","push","tableName","date","getUniqueMuscleGroups","muscleGroups","Set","rows","row","muscleGroup","trim","add","Array","from","sort","getUniqueExercises","exercises","exercise","getExercisesForMuscleGroup","createNewTable","crypto","randomUUID","today","split","sets","reps","weight","notes","showNotes","weightUnit"],"sources":["C:/Users/kidus/OneDrive/Documentos/Summer2025/fitness-tracker-frontend/src/components/TrainingLogManager.jsx"],"sourcesContent":["import { \r\n  doc, \r\n  setDoc, \r\n  getDoc, \r\n  getDocs, \r\n  deleteDoc, \r\n  collection,\r\n  query,\r\n  orderBy \r\n} from \"firebase/firestore\";\r\nimport { db, auth } from \"../utils/auth\";\r\n\r\nexport default class TrainingLogManager {\r\n  constructor() {\r\n    this.user = auth.currentUser;\r\n  }\r\n\r\n  // Get the current user's UID\r\n  getUserId() {\r\n    const user = auth.currentUser;\r\n    if (!user) {\r\n      throw new Error(\"User not authenticated\");\r\n    }\r\n    return user.uid;\r\n  }\r\n\r\n  // Get Firestore document reference for a specific table\r\n  getTableDoc(logId) {\r\n    const userId = this.getUserId();\r\n    return doc(db, \"users\", userId, \"tables\", logId);\r\n  }\r\n\r\n  // Get Firestore collection reference for user's tables\r\n  getTablesCollection() {\r\n    const userId = this.getUserId();\r\n    return collection(db, \"users\", userId, \"tables\");\r\n  }\r\n\r\n  async loadTable(id) {\r\n    try {\r\n      const docRef = this.getTableDoc(id);\r\n      const docSnap = await getDoc(docRef);\r\n      \r\n      if (docSnap.exists()) {\r\n        return docSnap.data();\r\n      } else {\r\n        return null;\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error loading table:\", error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async saveTable(log) {\r\n    try {\r\n      const docRef = this.getTableDoc(log.id);\r\n      await setDoc(docRef, {\r\n        ...log,\r\n        lastOpened: new Date().toISOString()\r\n      });\r\n      return { message: \"Saved\" };\r\n    } catch (error) {\r\n      console.error(\"Error saving table:\", error);\r\n      throw new Error(\"Save failed\");\r\n    }\r\n  }\r\n\r\n  async deleteTable(id) {\r\n    try {\r\n      const docRef = this.getTableDoc(id);\r\n      await deleteDoc(docRef);\r\n      return true;\r\n    } catch (error) {\r\n      console.error(\"Error deleting table:\", error);\r\n      throw new Error(\"Delete failed\");\r\n    }\r\n  }\r\n\r\n  async listTables() {\r\n    try {\r\n      const collectionRef = this.getTablesCollection();\r\n      const q = query(collectionRef, orderBy(\"lastOpened\", \"desc\"));\r\n      const querySnapshot = await getDocs(q);\r\n      \r\n      const tables = [];\r\n      querySnapshot.forEach((doc) => {\r\n        const data = doc.data();\r\n        tables.push({\r\n          id: data.id,\r\n          tableName: data.tableName,\r\n          date: data.date,\r\n          lastOpened: data.lastOpened\r\n        });\r\n      });\r\n      \r\n      return tables;\r\n    } catch (error) {\r\n      console.error(\"Error listing tables:\", error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Get all unique muscle groups from user's logs\r\n  async getUniqueMuscleGroups() {\r\n    try {\r\n      const collectionRef = this.getTablesCollection();\r\n      const querySnapshot = await getDocs(collectionRef);\r\n      \r\n      const muscleGroups = new Set();\r\n      querySnapshot.forEach((doc) => {\r\n        const data = doc.data();\r\n        if (data.rows) {\r\n          data.rows.forEach(row => {\r\n            if (row.muscleGroup && row.muscleGroup.trim()) {\r\n              muscleGroups.add(row.muscleGroup.trim());\r\n            }\r\n          });\r\n        }\r\n      });\r\n      \r\n      return Array.from(muscleGroups).sort();\r\n    } catch (error) {\r\n      console.error(\"Error fetching muscle groups:\", error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Get all unique exercises from user's logs\r\n  async getUniqueExercises() {\r\n    try {\r\n      const collectionRef = this.getTablesCollection();\r\n      const querySnapshot = await getDocs(collectionRef);\r\n      \r\n      const exercises = new Set();\r\n      querySnapshot.forEach((doc) => {\r\n        const data = doc.data();\r\n        if (data.rows) {\r\n          data.rows.forEach(row => {\r\n            if (row.exercise && row.exercise.trim()) {\r\n              exercises.add(row.exercise.trim());\r\n            }\r\n          });\r\n        }\r\n      });\r\n      \r\n      return Array.from(exercises).sort();\r\n    } catch (error) {\r\n      console.error(\"Error fetching exercises:\", error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Get exercises for a specific muscle group\r\n  async getExercisesForMuscleGroup(muscleGroup) {\r\n    try {\r\n      const collectionRef = this.getTablesCollection();\r\n      const querySnapshot = await getDocs(collectionRef);\r\n      \r\n      const exercises = new Set();\r\n      querySnapshot.forEach((doc) => {\r\n        const data = doc.data();\r\n        if (data.rows) {\r\n          data.rows.forEach(row => {\r\n            if (row.muscleGroup === muscleGroup && row.exercise && row.exercise.trim()) {\r\n              exercises.add(row.exercise.trim());\r\n            }\r\n          });\r\n        }\r\n      });\r\n      \r\n      return Array.from(exercises).sort();\r\n    } catch (error) {\r\n      console.error(\"Error fetching exercises for muscle group:\", error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  createNewTable() {\r\n    const id = crypto.randomUUID();\r\n    const today = new Date().toISOString().split(\"T\")[0];\r\n    return {\r\n      id,\r\n      tableName: \"New Log\",\r\n      date: today,\r\n      rows: [\r\n        {\r\n          id: 0,\r\n          muscleGroup: \"\",\r\n          exercise: \"\",\r\n          sets: [{ reps: \"\", weight: \"\" }],\r\n          notes: \"\",\r\n          showNotes: false,\r\n          weightUnit: \"lbs\",\r\n        },\r\n      ],\r\n    };\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}