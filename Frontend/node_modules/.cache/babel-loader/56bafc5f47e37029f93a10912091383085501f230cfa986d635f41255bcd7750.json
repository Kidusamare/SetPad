{"ast":null,"code":"import React,{useState,useRef,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{useTheme}from\"../context/ThemeContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AICoachingPage=()=>{const{theme}=useTheme();const navigate=useNavigate();const[messages,setMessages]=useState([{id:1,type:\"ai\",content:\"Hi! I'm your AI fitness coach. I can help you with workout planning, form analysis, nutrition advice, and tracking your progress. What would you like to work on today?\",timestamp:new Date()}]);const[inputMessage,setInputMessage]=useState(\"\");const[isLoading,setIsLoading]=useState(false);const[showBackButton,setShowBackButton]=useState(true);const[lastScrollY,setLastScrollY]=useState(0);const messagesEndRef=useRef(null);const inputRef=useRef(null);// Scroll detection for back button\nuseEffect(()=>{const handleScroll=()=>{const currentScrollY=window.scrollY;const isAtTop=currentScrollY<50;const isScrollingUp=currentScrollY<lastScrollY;setShowBackButton(isAtTop||isScrollingUp);setLastScrollY(currentScrollY);};window.addEventListener('scroll',handleScroll,{passive:true});return()=>window.removeEventListener('scroll',handleScroll);},[lastScrollY]);// Auto-scroll to bottom when new messages arrive\nuseEffect(()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});},[messages]);// Focus input on mount\nuseEffect(()=>{var _inputRef$current;(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.focus();},[]);const handleSendMessage=async()=>{if(!inputMessage.trim()||isLoading)return;const userMessage={id:Date.now(),type:\"user\",content:inputMessage.trim(),timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);setInputMessage(\"\");setIsLoading(true);try{// Call AI coaching API\nconst response=await fetch(\"\".concat(process.env.REACT_APP_API_URL||'http://localhost:8000',\"/ai-coaching\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({message:userMessage.content,conversation_history:messages.slice(-5)// Send last 5 messages for context\n})});if(!response.ok){throw new Error(\"Failed to get AI response\");}const data=await response.json();const aiMessage={id:Date.now()+1,type:\"ai\",content:data.response,timestamp:new Date()};setMessages(prev=>[...prev,aiMessage]);}catch(error){console.error(\"AI coaching error:\",error);const errorMessage={id:Date.now()+1,type:\"ai\",content:\"I'm sorry, I'm having trouble connecting right now. Please make sure the backend server is running and try again.\",timestamp:new Date()};setMessages(prev=>[...prev,errorMessage]);}finally{setIsLoading(false);}};const handleKeyPress=e=>{if(e.key===\"Enter\"&&!e.shiftKey){e.preventDefault();handleSendMessage();}};const quickActions=[\"📋 Create a workout plan\",\"🎯 Set fitness goals\",\"💪 Analyze my progress\",\"🍎 Nutrition advice\",\"🔥 Quick HIIT workout\",\"🏋️ Form check tips\"];const handleQuickAction=action=>{var _inputRef$current2;setInputMessage(action.substring(2));// Remove emoji\n(_inputRef$current2=inputRef.current)===null||_inputRef$current2===void 0?void 0:_inputRef$current2.focus();};const formatTime=timestamp=>{return timestamp.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});};return/*#__PURE__*/_jsxs(\"div\",{style:{background:theme.background,minHeight:\"100vh\",color:theme.text,display:\"flex\",flexDirection:\"column\",transition:\"background-color 0.3s ease, color 0.3s ease\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{position:\"sticky\",top:0,zIndex:100,background:theme.background,borderBottom:\"1px solid \".concat(theme.border),transition:\"all 0.3s ease\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"1rem 2rem\",display:\"flex\",alignItems:\"center\",gap:\"1rem\"},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/\"),style:{background:theme.accentSecondary,color:theme.accent,padding:\"0.7rem 1.4rem\",border:\"none\",borderRadius:\"10px\",fontWeight:\"600\",fontSize:\"1rem\",cursor:\"pointer\",transition:\"all 0.3s ease\",opacity:showBackButton?1:0,transform:showBackButton?\"translateX(0)\":\"translateX(-10px)\",pointerEvents:showBackButton?\"auto\":\"none\"},onMouseOver:e=>e.currentTarget.style.background=theme.accentHover,onMouseOut:e=>e.currentTarget.style.background=theme.accentSecondary,children:\"\\u2190 Back to Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:\"1.8rem\",margin:0,color:theme.accent,fontWeight:\"700\"},children:\"\\uD83E\\uDD16 AI Fitness Coach\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:\"0.2rem 0 0 0\",color:theme.textSecondary,fontSize:\"0.9rem\"},children:\"Your personal AI trainer is here to help\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,padding:\"2rem\",paddingBottom:\"1rem\",overflowY:\"auto\"},children:[messages.length<=1&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"2rem\",background:theme.cardBackground,borderRadius:\"16px\",padding:\"1.5rem\",border:\"1px solid \".concat(theme.cardBorder),boxShadow:theme.shadowLight},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:\"0 0 1rem 0\",color:theme.accent,fontSize:\"1.1rem\"},children:\"Quick Actions\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"grid\",gridTemplateColumns:\"repeat(auto-fit, minmax(200px, 1fr))\",gap:\"0.8rem\"},children:quickActions.map((action,index)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleQuickAction(action),style:{background:theme.surfaceSecondary,color:theme.text,border:\"1px solid \".concat(theme.border),borderRadius:\"8px\",padding:\"0.8rem 1rem\",cursor:\"pointer\",fontSize:\"0.9rem\",fontWeight:\"500\",transition:\"all 0.2s ease\",textAlign:\"left\"},onMouseOver:e=>{e.currentTarget.style.background=theme.surfaceTertiary;e.currentTarget.style.borderColor=theme.accent;e.currentTarget.style.transform=\"translateY(-1px)\";},onMouseOut:e=>{e.currentTarget.style.background=theme.surfaceSecondary;e.currentTarget.style.borderColor=theme.border;e.currentTarget.style.transform=\"translateY(0)\";},children:action},index))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:\"1rem\"},children:[messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:message.type===\"user\"?\"flex-end\":\"flex-start\",alignItems:\"flex-start\",gap:\"0.8rem\"},children:[message.type===\"ai\"&&/*#__PURE__*/_jsx(\"div\",{style:{width:\"40px\",height:\"40px\",borderRadius:\"50%\",background:\"linear-gradient(135deg, \".concat(theme.accent,\", \").concat(theme.accentHover,\")\"),display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:\"1.2rem\",flexShrink:0},children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"70%\",background:message.type===\"user\"?theme.accent:theme.cardBackground,color:message.type===\"user\"?theme.background:theme.text,padding:\"1rem 1.2rem\",borderRadius:message.type===\"user\"?\"18px 18px 4px 18px\":\"18px 18px 18px 4px\",border:message.type===\"ai\"?\"1px solid \".concat(theme.cardBorder):\"none\",boxShadow:message.type===\"user\"?\"0 2px 8px rgba(0,0,0,0.15)\":theme.shadowLight,wordWrap:\"break-word\",lineHeight:\"1.5\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:\"0.5rem\"},children:message.content}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"0.75rem\",opacity:0.7,textAlign:\"right\"},children:formatTime(message.timestamp)})]}),message.type===\"user\"&&/*#__PURE__*/_jsx(\"div\",{style:{width:\"40px\",height:\"40px\",borderRadius:\"50%\",background:theme.surfaceSecondary,border:\"2px solid \".concat(theme.border),display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:\"1.2rem\",flexShrink:0},children:\"\\uD83D\\uDC64\"})]},message.id)),isLoading&&/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"flex-start\",alignItems:\"flex-start\",gap:\"0.8rem\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:\"40px\",height:\"40px\",borderRadius:\"50%\",background:\"linear-gradient(135deg, \".concat(theme.accent,\", \").concat(theme.accentHover,\")\"),display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:\"1.2rem\"},children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsxs(\"div\",{style:{background:theme.cardBackground,border:\"1px solid \".concat(theme.cardBorder),borderRadius:\"18px 18px 18px 4px\",padding:\"1rem 1.2rem\",display:\"flex\",alignItems:\"center\",gap:\"0.5rem\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"0.3rem\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:\"8px\",height:\"8px\",borderRadius:\"50%\",background:theme.accent,animation:\"pulse 1.4s ease-in-out infinite\"}}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"8px\",height:\"8px\",borderRadius:\"50%\",background:theme.accent,animation:\"pulse 1.4s ease-in-out 0.2s infinite\"}}),/*#__PURE__*/_jsx(\"div\",{style:{width:\"8px\",height:\"8px\",borderRadius:\"50%\",background:theme.accent,animation:\"pulse 1.4s ease-in-out 0.4s infinite\"}})]}),/*#__PURE__*/_jsx(\"span\",{style:{color:theme.textSecondary,fontSize:\"0.9rem\"},children:\"AI is thinking...\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(\"div\",{style:{padding:\"1rem 2rem 2rem 2rem\",borderTop:\"1px solid \".concat(theme.border),background:theme.background},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"1rem\",alignItems:\"flex-end\",maxWidth:\"1000px\",margin:\"0 auto\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{flex:1},children:/*#__PURE__*/_jsx(\"textarea\",{ref:inputRef,value:inputMessage,onChange:e=>setInputMessage(e.target.value),onKeyPress:handleKeyPress,placeholder:\"Ask me anything about fitness, nutrition, or workouts...\",disabled:isLoading,style:{width:\"100%\",minHeight:\"50px\",maxHeight:\"120px\",padding:\"1rem\",borderRadius:\"12px\",border:\"1px solid \".concat(theme.inputBorder),background:theme.inputBackground,color:theme.text,fontSize:\"1rem\",resize:\"vertical\",outline:\"none\",transition:\"all 0.3s ease\",fontFamily:\"inherit\",lineHeight:\"1.4\"},onFocus:e=>e.currentTarget.style.borderColor=theme.accent,onBlur:e=>e.currentTarget.style.borderColor=theme.inputBorder})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSendMessage,disabled:!inputMessage.trim()||isLoading,style:{background:!inputMessage.trim()||isLoading?theme.surfaceSecondary:theme.accent,color:!inputMessage.trim()||isLoading?theme.textMuted:theme.background,border:\"none\",borderRadius:\"12px\",padding:\"1rem 1.5rem\",fontSize:\"1rem\",fontWeight:\"600\",cursor:!inputMessage.trim()||isLoading?\"not-allowed\":\"pointer\",transition:\"all 0.3s ease\",minWidth:\"80px\",height:\"50px\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},onMouseOver:e=>{if(!(!inputMessage.trim()||isLoading)){e.currentTarget.style.background=theme.accentHover;}},onMouseOut:e=>{if(!(!inputMessage.trim()||isLoading)){e.currentTarget.style.background=theme.accent;}},children:isLoading?\"...\":\"Send\"})]})}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n                @keyframes pulse {\\n                    0%, 80%, 100% {\\n                        transform: scale(0.6);\\n                        opacity: 0.5;\\n                    }\\n                    40% {\\n                        transform: scale(1);\\n                        opacity: 1;\\n                    }\\n                }\\n            \"})]});};export default AICoachingPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}