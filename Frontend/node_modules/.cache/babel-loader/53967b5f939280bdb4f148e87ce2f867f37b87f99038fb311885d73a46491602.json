{"ast":null,"code":"import{useCallback,useEffect,useRef}from'react';/**\n * Custom hook for debounced auto-save functionality\n * Prevents infinite loops by debouncing save operations and tracking save state\n * \n * @param {Function} saveFunction - Function to call for saving data\n * @param {*} data - Data to save (will trigger save when changed)\n * @param {number} delay - Debounce delay in milliseconds (default: 2000)\n * @param {boolean} enabled - Whether auto-save is enabled (default: true)\n * @returns {Object} - { save: manualSaveFunction, isSaving: boolean, lastSaved: Date }\n */export const useAutoSave=function(saveFunction,data){let delay=arguments.length>2&&arguments[2]!==undefined?arguments[2]:2000;let enabled=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;const timeoutRef=useRef(null);const isSavingRef=useRef(false);const lastSavedDataRef=useRef(null);const lastSavedTimeRef=useRef(null);// Create a stable save function that doesn't change on every render\nconst stableSaveFunction=useCallback(saveFunction,[]);// Manual save function that can be called immediately\nconst manualSave=useCallback(async()=>{if(isSavingRef.current)return;try{isSavingRef.current=true;await stableSaveFunction(data);lastSavedDataRef.current=JSON.stringify(data);lastSavedTimeRef.current=new Date();}catch(error){console.error('Save failed:',error);throw error;}finally{isSavingRef.current=false;}},[data,stableSaveFunction]);// Auto-save effect\nuseEffect(()=>{if(!enabled||!data)return;// Don't auto-save if data hasn't changed\nconst currentDataString=JSON.stringify(data);if(currentDataString===lastSavedDataRef.current){return;}// Don't auto-save if currently saving\nif(isSavingRef.current){return;}// Clear existing timeout\nif(timeoutRef.current){clearTimeout(timeoutRef.current);}// Set new timeout for debounced save\ntimeoutRef.current=setTimeout(async()=>{try{await manualSave();console.log('Auto-saved at:',new Date().toLocaleTimeString());}catch(error){console.error('Auto-save failed:',error);}},delay);// Cleanup function\nreturn()=>{if(timeoutRef.current){clearTimeout(timeoutRef.current);}};},[data,delay,enabled,manualSave]);// Cleanup on unmount\nuseEffect(()=>{return()=>{if(timeoutRef.current){clearTimeout(timeoutRef.current);}};},[]);return{save:manualSave,isSaving:isSavingRef.current,lastSaved:lastSavedTimeRef.current};};","map":{"version":3,"names":["useCallback","useEffect","useRef","useAutoSave","saveFunction","data","delay","arguments","length","undefined","enabled","timeoutRef","isSavingRef","lastSavedDataRef","lastSavedTimeRef","stableSaveFunction","manualSave","current","JSON","stringify","Date","error","console","currentDataString","clearTimeout","setTimeout","log","toLocaleTimeString","save","isSaving","lastSaved"],"sources":["C:/Users/kidus/OneDrive/Documentos/Summer2025/fitness-tracker-frontend/Frontend/src/hooks/useAutoSave.js"],"sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\n\n/**\n * Custom hook for debounced auto-save functionality\n * Prevents infinite loops by debouncing save operations and tracking save state\n * \n * @param {Function} saveFunction - Function to call for saving data\n * @param {*} data - Data to save (will trigger save when changed)\n * @param {number} delay - Debounce delay in milliseconds (default: 2000)\n * @param {boolean} enabled - Whether auto-save is enabled (default: true)\n * @returns {Object} - { save: manualSaveFunction, isSaving: boolean, lastSaved: Date }\n */\nexport const useAutoSave = (saveFunction, data, delay = 2000, enabled = true) => {\n    const timeoutRef = useRef(null);\n    const isSavingRef = useRef(false);\n    const lastSavedDataRef = useRef(null);\n    const lastSavedTimeRef = useRef(null);\n\n    // Create a stable save function that doesn't change on every render\n    const stableSaveFunction = useCallback(saveFunction, []);\n\n    // Manual save function that can be called immediately\n    const manualSave = useCallback(async () => {\n        if (isSavingRef.current) return;\n        \n        try {\n            isSavingRef.current = true;\n            await stableSaveFunction(data);\n            lastSavedDataRef.current = JSON.stringify(data);\n            lastSavedTimeRef.current = new Date();\n        } catch (error) {\n            console.error('Save failed:', error);\n            throw error;\n        } finally {\n            isSavingRef.current = false;\n        }\n    }, [data, stableSaveFunction]);\n\n    // Auto-save effect\n    useEffect(() => {\n        if (!enabled || !data) return;\n\n        // Don't auto-save if data hasn't changed\n        const currentDataString = JSON.stringify(data);\n        if (currentDataString === lastSavedDataRef.current) {\n            return;\n        }\n\n        // Don't auto-save if currently saving\n        if (isSavingRef.current) {\n            return;\n        }\n\n        // Clear existing timeout\n        if (timeoutRef.current) {\n            clearTimeout(timeoutRef.current);\n        }\n\n        // Set new timeout for debounced save\n        timeoutRef.current = setTimeout(async () => {\n            try {\n                await manualSave();\n                console.log('Auto-saved at:', new Date().toLocaleTimeString());\n            } catch (error) {\n                console.error('Auto-save failed:', error);\n            }\n        }, delay);\n\n        // Cleanup function\n        return () => {\n            if (timeoutRef.current) {\n                clearTimeout(timeoutRef.current);\n            }\n        };\n    }, [data, delay, enabled, manualSave]);\n\n    // Cleanup on unmount\n    useEffect(() => {\n        return () => {\n            if (timeoutRef.current) {\n                clearTimeout(timeoutRef.current);\n            }\n        };\n    }, []);\n\n    return {\n        save: manualSave,\n        isSaving: isSavingRef.current,\n        lastSaved: lastSavedTimeRef.current\n    };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}